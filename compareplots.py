import numpy as np
import matplotlib.pyplot as pl
import matplotlib as mpl

x1 = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]
x = [val * 0.40212336 for val in x1]

'''
10th mag
flux = 1150000

# m10cdpp = [312.24129386121569, 354.76883029473817, 442.7849919598425, 486.0712606913861, 505.45802945263256]
# m10cdppn = [1.2732594733605547, 1.446678523650349, 1.8055913703884863, 1.9821043839214301, 2.0611598691132098]
# m10cdpp = [309.59794862448155, 360.54927734892209, 471.68796131692596, 639.9102151372615, 803.93757777631492]
# m10cdppn = [1.204689262107806, 1.4029480647812964, 1.8354043513164586, 2.4899808552155127, 3.1282344461745626]
m10cdpp = [18.791998106883419, 26.150987528060533, 29.861926302798992, 34.704987086653688, 63.448982744253385,\
           109.27389687284278, 112.26004069029557, 114.59486391524118, 125.0226093740587, 126.07098170068483,\
           133.71806506097502, 300.23051367522538, 752.7673528684544, 1216.6860738127029, 1392.9562618204204,\
           3606.3967659317377, 7027.8677107829571, 9059.0888336161588, 12057.807983148832, 17213.793205627844]
m10cdppn = [1.1545135400490163, 1.6066236817967632, 1.8346105641580981, 2.1321509969762853, 3.898079877612632,\
            7.3555833076854951, 7.5565904122784922, 7.7137549980696534, 8.4156806420587777, 8.4862500113834933,\
            9.0010001971747471, 20.209497584012336, 50.671231957372335, 81.899118008431458, 93.764440740180575,\
            242.7583586887811, 473.06875568106716, 609.79689124592267, 811.65048256065825, 1158.7167071803556]
'''
m10cdpp = [42.155794511298112, 47.709244490908326, 30.645143091718488, 49.934795066445133, 105.28084077524926, 125.01702459837263, 121.13004335098643, 140.0445785908945, 136.42327015753617, 127.87193138608002, 147.90393896984122, 146.34146995457473, 156.80507147308936, 156.33522857045924, 159.32905300815952, 165.61629344470947, 161.56311584649708, 168.82574520889639, 180.40707463082691, 176.62188513276621]
m10cdppn = [1.904193168778346, 2.1550446030098103, 1.3842526942730453, 2.2555735635438623, 4.755575363518326, 5.6470662451259086, 5.4714898332886541, 6.3258665378908505, 6.1622906674611695, 5.7760234635978405, 6.6808768162654308, 6.6102995003877556, 7.0829443351810903, 7.06172135371534, 7.1969535349345239, 7.4809505614058613, 7.2978669975960759, 7.6259227104481582, 8.1490557370289132, 7.9780772969758624]
nmv10 = m10cdpp[0] / m10cdppn[0]
m10cdppnn = [(val - nmv10)/nmv10 for val in m10cdpp]


'''
11th mag
flux = 454000

# m11cdpp = [445.84291666328073, 451.05992319193638, 537.6077838874528, 541.60906003746652, 540.17527570643813]
# m11cdppn = [1.1717027442592469, 1.1854133598998244, 1.4128664876643089, 1.4233820887208375, 1.419614014871162]
# m11cdpp = [446.52185630132101, 479.20150336396364, 559.48066459617098, 707.2823423448034, 855.73671862785341]
# m11cdppn = [1.0968388372936619, 1.177113308927068, 1.3743114989422611, 1.7373723840570643, 2.1020365615784784]
m11cdpp = [42.052230307811875, 62.398939086588506, 69.899736498361918, 79.536199203339081, 88.729716625453207,\
            206.6327601234544, 267.49847819764102, 271.1514717499723, 285.09384979706084, 284.41885350381244,\
            290.754431753105, 404.04995341987581, 802.19839008791519, 1228.4152401834069, 1562.8515669071087,\
            4112.3248602197464, 7770.403129876504, 8881.0399947695041, 13202.449384509073, 18303.761851202951]
m11cdppn = [1.0938920812071411, 1.623164927113651, 1.8182809252763867, 2.0689513455290851, 2.3080995627075289,\
            5.9034609768918545, 7.6423836494960646, 7.7467490215316559, 8.145080267152558, 8.1257957438545212,\
            8.3068020805960785, 11.543634858790522, 22.918664440140407, 35.095603569875713, 44.650389572292987,\
            117.48838529817375, 221.99902679777165, 253.72972326369526, 377.19161615163654, 522.93520037355063]
'''
m11cdpp = [63.527514594340488, 76.176293800845883, 86.09041144414708, 97.70399161598975, 101.09499426494541, 224.5498055635255, 274.69067472093604, 288.52535228663555, 287.1877383739494, 271.38252753409074, 282.43061303568248, 298.84799405294916, 299.73473454129919, 297.4512686381446, 300.78910136482909, 311.91348286013027, 307.98853247494128, 317.09861733115832, 309.12120997566274, 316.41140351955772]
m11cdppn = [1.1511506388933774, 1.3803529043647726, 1.5600017216060345, 1.7704456579070962, 1.8318923379914798, 4.0689558498934941, 4.9775337146784722, 5.2282250571673794, 5.2039868177208373, 4.9175884174004709, 5.1177853047636512, 5.4152765377776095, 5.4313447231334342, 5.3899671680678409, 5.4504503823156778, 5.6520297916060018, 5.5809077089558858, 5.7459870461465998, 5.6014323971471631, 5.7335343849126144]
nmv11 = m11cdpp[0] / m11cdppn[0]
m11cdppnn = [(val - nmv11)/nmv11 for val in m11cdpp]

'''
12th mag
flux = 159000
# m12cdpp = [637.81563556843287, 617.36846017067558, 680.71054910724308, 685.44862849027743, 660.686867489576]
# m12cdppn = [1.0801966873093451, 1.045567603452211, 1.1528429833910474, 1.1608673361480963, 1.1189311233723378]
# m12cdpp = [673.34870364327287, 691.72025880522733, 750.74171415797002, 867.91401099393863, 1015.2629888184431]
# m12cdppn = [1.0154746194862541, 1.0431806919662567, 1.1321907243485327, 1.308897819647066, 1.5311142527944561]
m12cdpp = [113.21972909949879, 130.38231643012813, 185.66737376238092, 205.80422066023849, 227.16195549528933,\
           255.24536752178437, 589.5132400646504, 708.78791961716377, 783.8909104313426, 794.70459849399663,\
           803.39972483465624, 865.83558630841344, 1145.2113618055544, 1339.4490427525911, 1682.6918726911413,
           4511.2472786818207, 7375.1629596071871, 10118.925851207645, 15299.495545968337, 18663.672108026385]
m12cdppn = [1.063730742554023, 1.2249780084727984, 1.7443964486679475, 1.933587707768474, 2.1342495475030927,\
           2.6461779390194367, 6.111597423940748, 7.3481410242414915, 8.1267482106379223, 8.238855799773269,
           8.3289998510563024, 8.9762844652283071, 11.872626996318068, 13.886326485710279, 17.444791084416355,
           46.768970352774254, 76.459736409203217, 104.90485533201246, 158.61282022449345, 193.4898872910465]
'''
m12cdpp = [125.41331487149141, 136.48551691490667, 208.36502347295126, 221.2291652159177, 228.3888204310625, 261.78345888071578, 619.43152056145072, 727.19361107191355, 791.33121447678127, 735.54671409366824, 771.34066568918945, 824.08514862265451, 818.94777007975472, 786.52981611375492, 798.13003335219673, 812.90412184208344, 820.50574452352942, 842.46791586755637, 792.36616130090135, 811.49641328649955]
m12cdppn = [1.0904741880912414, 1.1867474629508317, 1.8117428761938354, 1.9235971441160749, 1.9858506553620567, 2.2762184786454216, 5.3859838180221633, 6.3229798481233042, 6.8806590791579652, 6.3956104395802322, 6.706840394268049, 7.1654559508546738, 7.1207862225947487, 6.8389107130694935, 6.9397751028492696, 7.0682364402065163, 7.1343328776559192, 7.3252949058077048, 6.8896579864821703, 7.0559963535315697]
nmv12 = m12cdpp[0] / m12cdppn[0]
m12cdppnn = [(val - nmv12)/nmv12 for val in m12cdpp]

'''
13th mag
flux = 68000

# m13cdpp = [823.51993040031107, 776.46634763751729, 814.92968708599233, 835.45350532180032, 794.41229576850162]
# m13cdppn = [1.0480756418876049, 0.98819158548929242, 1.0371430287919525, 1.0632632393386756, 1.0110309976423417]
# m13cdpp = [927.26098528952934, 929.57057153990957, 981.4924090743782, 1075.975865157247, 1266.0690412668944]
# m13cdppn = [0.99462187862371743, 0.99709924481472501, 1.0527929453040255, 1.1541401539959359, 1.3580426527910199]
m13cdpp = [260.86608932542225, 273.84796289504703, 408.46210618977227, 452.71625252995256, 495.18069092783071,\
           539.08995923685393, 710.35453854364482, 892.22545960832599, 1705.2743259659169, 1819.413596652128,\
           1847.4447817270986, 1874.4514989237887, 2073.8361997369816, 2195.719975757364, 3319.0081148766026,\
           5219.1265306099403, 8848.8705085484125, 10362.133037619524, 14055.664090686023, 18750.779097005445]
m13cdppn = [1.0668135245596371, 1.1199029787466952, 1.6704083703642127, 1.8513859821175425, 2.0250445719052461,\
           2.4029197754901688, 3.1663082181906583, 3.9769729789136914, 7.6010271204083715, 8.1097873115278283,\
           8.2347324858776219, 8.3551112347507477, 9.2438412737825306, 9.7871215384073693, 14.794024814595575,
           23.263542821204652, 39.442630253850794, 46.187791046236512, 62.651200643707973, 83.579033751296507]
'''
m13cdpp = [280.31076569399835, 281.83533361964641, 433.72917455862631, 493.11417782172413, 503.90184347312714, 571.71916210541224, 768.42181916086827, 978.84606750211287, 1529.4917668888916, 1515.9572549219245, 1516.7247290729072, 1638.3277498965654, 1725.1147909338513, 1763.1538793791442, 1789.119852813059, 1833.0761511678477, 1858.5119847231344, 1865.4271819049509, 1770.2732087522891, 1854.8586347349717]
m13cdppn = [1.164987294606215, 1.1713234845800351, 1.8026028233694038, 2.049410234138568, 2.0942443788109268, 2.3760969661179758, 3.193604262769751, 4.0681392639056764, 6.3566537347178302, 6.3004035423958378, 6.3035932080964034, 6.8089821962594437, 7.1696740159067796, 7.3277666051352108, 7.4356826499139395, 7.6183674960505687, 7.724080249701907, 7.7528201977968987, 7.3573549380888039, 7.7088967218469486]
nmv13 = m13cdpp[0] / m13cdppn[0]
m13cdppnn = [(val - nmv13)/nmv13 for val in m13cdpp]

'''
14th mag
flux = 28000

# m14cdpp = [987.83546813148746, 914.31356230014694, 943.62011726871913, 955.23347913673308, 937.96020160430248]
# m14cdppn = [1.0374214403987652, 0.96020898558310219, 0.9909866296842299, 1.0031829427198167, 0.98504260555213308]
# m14cdpp = [1229.9048325118938, 1213.6498499991944, 1254.7297725032199, 1331.931940062861, 1542.510761142601]
# m14cdppn = [0.99984283012684638, 0.98662845183550607, 1.0200240974920323, 1.0827850783941966, 1.2539737093089434]
m14cdpp = [629.58525041123539, 655.26508649840707, 758.40166781355242, 1052.7973786918615, 1130.5333416346054,\
           1219.3584529731656, 1389.1841767363337, 1408.3925956752876, 1552.9642830044761, 2848.6813682845977,\
           4146.1455740426773, 4149.5290203609929, 4305.2956403766675, 4813.8351775522506, 6521.2238919111169,\
           7995.7637075488501, 10249.234663225308, 11763.36788879043, 15950.88703960838, 19081.903726687848]
m14cdppn = [1.0688067546733779, 1.1124017757621762, 1.2874901767238329, 1.7872670125504055, 1.9192344025424273,\
            2.2149139802885882, 2.5233953533077385, 2.5582866484337869, 2.8208951132691698, 5.1745113773693872,\
            7.5313012132461736, 7.5374471029422843, 7.8203906979891551, 8.7441316436259786, 11.845532321990438,\
            14.523972647872236, 18.617309034504, 21.367669144893497, 28.974123741782233, 34.661485498138376]
'''
m14cdpp = [671.10028825049983, 673.06756268741378, 771.29002793005475, 1075.9870955328804, 1129.8276828862038, 1193.1271176658217, 1386.5860484123434, 1421.7600274089484, 1910.1709313011595, 2927.6935237054231, 2901.7496853630978, 2998.7514667853256, 3232.1896123063671, 3414.3444147709934, 3815.8066326542112, 4177.576911133775, 4125.0709769115292, 4256.6805953448002, 4084.4834704436876, 4230.6971021245117]
m14cdppn = [1.1430265624661022, 1.1463772493551145, 1.3136710037594264, 1.8326349319131259, 1.9243369063587901, 2.0321493102705985, 2.3616510262749646, 2.4215597955075849, 3.2534274706090645, 4.9864849158076456, 4.9422970397527699, 5.1075117099195495, 5.5051065339643586, 5.8153549146357673, 6.4991304797801925, 7.1153022279564491, 7.025873451730499, 7.2500326308860066, 6.9567442935268131, 7.2057772141376812]
nmv14 = m14cdpp[0] / m14cdppn[0]
m14cdppnn = [(val - nmv14)/nmv14 for val in m14cdpp]

'''
Plots
'''

fig1 = pl.figure()
pl.plot(x,m10cdpp,'m', label=r'$\mathrm{K_p\ Mag=10}$')
pl.plot(x,m11cdpp,'k', label=r'$\mathrm{K_p\ Mag=11}$')
pl.plot(x,m12cdpp,'r', label=r'$\mathrm{K_p\ Mag=12}$')
pl.plot(x,m13cdpp,'b', label=r'$\mathrm{K_p\ Mag=13}$')
pl.plot(x,m14cdpp,'g', label=r'$\mathrm{K_p\ Mag=14}$')
pl.title("CDPP vs. Motion")
legend = pl.legend(loc=0)
pl.xlim([x[0],x[-1]])
pl.xlabel("Motion (pixels)")
pl.ylabel("CDPP")

fig2 = pl.figure()
pl.plot(x,m10cdppn,'m', label=r'$\mathrm{K_p\ Mag=10}$')
pl.plot(x,m11cdppn,'k', label=r'$\mathrm{K_p\ Mag=11}$')
pl.plot(x,m12cdppn,'r', label=r'$\mathrm{K_p\ Mag=12}$')
pl.plot(x,m13cdppn,'b', label=r'$\mathrm{K_p\ Mag=13}$')
pl.plot(x,m14cdppn,'g', label=r'$\mathrm{K_p\ Mag=14}$')
pl.title("Normalized CDPP vs. Motion")
pl.xlabel("Motion (pixels)")
pl.ylabel("Normalized CDPP")
legend = pl.legend(loc=0)
pl.xlim([x[0],x[-1]])

fig3 = pl.figure()
kpmag = [10,11,12,13,14]
cmap = mpl.cm.autumn
for i in range(20):
    cdpp = [m10cdpp[i],m11cdpp[i],m12cdpp[i],m13cdpp[i],m14cdpp[i]]
    pl.plot(kpmag, cdpp, color=cmap(i/20),label=('%.1f pixels' % x[i]))
'''
cdpp1 = [m10cdpp[0],m11cdpp[0],m12cdpp[0],m13cdpp[0],m14cdpp[0]]
cdpp2 = [m10cdpp[1],m11cdpp[1],m12cdpp[1],m13cdpp[1],m14cdpp[1]]
cdpp3 = [m10cdpp[2],m11cdpp[2],m12cdpp[2],m13cdpp[2],m14cdpp[2]]
cdpp4 = [m10cdpp[3],m11cdpp[3],m12cdpp[3],m13cdpp[3],m14cdpp[3]]
cdpp5 = [m10cdpp[4],m11cdpp[4],m12cdpp[4],m13cdpp[4],m14cdpp[4]]
pl.plot(kpmag,cdpp1,'m', label=r'$\mathrm{Motion\ Coefficient=1}$')
pl.plot(kpmag,cdpp2,'k', label=r'$\mathrm{Motion\ Coefficient=2}$')
pl.plot(kpmag,cdpp3,'r', label=r'$\mathrm{Motion\ Coefficient=3}$')
pl.plot(kpmag,cdpp4,'b', label=r'$\mathrm{Motion\ Coefficient=4}$')
pl.plot(kpmag,cdpp5,'g', label=r'$\mathrm{Motion\ Coefficient=5}$')
'''
pl.xlabel('Kp Mag')
pl.ylabel('CDPP')
pl.title('CDDPP vs. Kp Mag')
legend = pl.legend(loc=0)
pl.show()
